<main>
  <h1>Hello <%= @user.name %></h1>
  <h3><%= link_to "Edit Info", edit_user_path(@user) %></h3>

  <article>
    <section>
      <h2>Email:</h2>
      <h3><%= @user.email %></h3>
    </section>
    <section>
      <h2>Address:</h2>
      <h3><%= @user.address %></h3>
    </section>

  </article>

  <table>
    <h2> Your Orders </h2>
    <tr>
      <th>Order ID</th>
      <th>Total Price</th>
      <th>Status</th>
      <th>Order Date</th>
    </tr>
    <% @order.each do |order| %>
    <tr>
      <td><%= link_to order.id, order_path(order) %></td>
      <td><%= order.cost %></td>
      <td><%= order.status %></td>
      <td><%= order.created_at %></td>
    </tr>
    <% end %>
  </table>

  <%if current_admin? %>
  <h2> Total Number Of Orders With Ordered Status: <%=@total_ordered%></h2>
  <h2> Total Number Of Orders With Paid Status: <%=@total_paid%></h2>
  <h2> Total Number Of Orders With Cancelled Status: <%=@total_cancelled%></h2>
  <h2> Total Number Of Orders With Completed Status: <%=@total_completed%></h2>

  <%= link_to 'Ordered', user_path(current_user, status: 'ordered') %>
  <%= link_to 'Completed', user_path(current_user, status: 'completed') %>
  <%= link_to 'Paid', user_path(current_user, status: 'paid') %>
  <%= link_to 'Cancelled', user_path(current_user, status: 'cancelled') %>
  <%= link_to 'All Orders', user_path(current_user) %>
    <table class='orders-table'>
      <h2> <%=@header%></h2>
      <tr>
        <th>Order ID</th>
        <th>Total Price</th>
        <th>Status</th>
        <th>Order Date</th>
        <th></th>
      </tr>
      <% @all_orders.each do |order| %>
      <tr>
        <td><%= link_to order.id, order_path(order) %></td>
        <td><%= order.cost %></td>
        <td><%= order.status %></td>
        <td><%= order.created_at %></td>
        <%if order.status =='paid' || order.status == 'ordered' %>
        <td><%= button_to 'Cancel', admin_order_path(order, status: 'cancelled'), method: :put %></td>
        <%end%>
        <%if order.status == 'ordered' %>
        <td><%= button_to 'Mark as Paid', admin_order_path(order, status: 'paid'), method: :put %></td>
        <%end%>
        <%if order.status == 'paid' %>
        <td><%= button_to 'Mark as Completed', admin_order_path(order, status: 'completed'), method: :put %></td>
        <%end%>
      </tr>
      <% end %>
    </table>
  <%end%>
</main>
